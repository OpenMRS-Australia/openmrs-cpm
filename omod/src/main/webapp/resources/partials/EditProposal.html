<cpm-menu menu="menu"></cpm-menu>
<div ng-show="isLoading" class="loading"><img ng-src="{{contextPath}}/images/loading.gif" /> Loading...</div>
<h2 id="headerText"><span ng-show="isEdit">Edit</span><span ng-show="!isEdit">Create</span> Concept Proposal</h2>
<p>
 <span style="font-size: smaller;"><span class="required">*</span> denotes required field</span>
 <span style="color: firebrick; margin-left: 2em; font-weight: bold;">{{errorMessage}}</span>
</p>
<p>
  Status: {{proposal.status | proposalStatus}}
</p>
<form name="form" novalidate >
<p>
 <label>Name<span class="required">*</span><br/><input type="text" name="name" class="name" ng-model="proposal.name" required ng-mouseenter="errorMessage=nameErrorMsg()" ng-mouseleave="errorMessage=''" ng-disabled="isReadOnly" /></label>
</p>
<p>
 <label>Your email (for notifications)<span class="required">*</span><br/><input type="email" class="email" ng-mouseenter="errorMessage=emailErrorMsg()" ng-mouseleave="errorMessage=''" ng-model="proposal.email" name="email" required ng-disabled="isReadOnly" /></label>
</p>
<p>
 <label>Overall description/comments (eg what form are these concepts from?)<br/><textarea cols="80" rows="6" ng-model="proposal.description" ng-disabled="isReadOnly"></textarea></label>
</p>

<p>
<h3>Concepts</h3>
<table class="conceptTable" cellpadding="5" cellspacing="0">
 <thead>
  <tr><td>Name</td><td>Datatype</td><td colspan="2">Comments</td></tr>
 </thead>
 <tbody class="noConceptsMsg" ng-show="proposal.concepts.length == 0">
  <tr><td colspan="4" align="center"><em>No concepts added</em></td></tr>
 </tbody>
 <tbody class="conceptList results">
  <tr ng-repeat="concept in proposal.concepts">
   <td>{{concept.preferredName}}</td>
   <td>{{concept.datatype}}</td>
   <td><input ng-model="concept.comment" ng-disabled="isReadOnly"/></td>
   <td><button ng-click="removeConcept(concept)" ng-disabled="isReadOnly">Remove</button></td>
  </tr>
 </tbody>
</table>
<button ng-click="dialog='open'" accesskey="a" ng-disabled="isReadOnly"><span class="accesskey">A</span>dd Concepts</button>
</p>

<div>
 <button ng-click="save()" ng-disabled="form.$invalid || isReadOnly" accesskey="s"><span class="accesskey">S</span>ave Draft</button>
 <button ng-click="submit()" ng-show="proposal.status == 'DRAFT'" ng-disabled="!isEdit || form.$invalid || isSubmitting || proposal.concepts.length < 1 || isReadOnly" accesskey="e" ng-switch="isSubmitting">
  <span ng-switch-when="true">Sending...</span>
  <span ng-switch-default>S<span class="accesskey">e</span>nd Proposal</span>
 </button>
 <button ng-click="deleteProposal()" ng-disabled="!isEdit || isReadOnly" accesskey="d"><span class="accesskey">D</span>elete Proposal</button>
</div>
</form>

<div jquery-ui-dialog title="Add concepts">
  <div ng-include="resourceLocation + '/partials/SearchConceptsDialog.html'"></div>
</div>

